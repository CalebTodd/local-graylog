{
  "v": 1,
  "id": "a282f1ab-8d32-44cd-9a06-26c9d08762c9",
  "rev": 1,
  "name": "AWS ELB Logs",
  "summary": "AWS ELB Logs",
  "description": "AWS ELB Logs",
  "vendor": "Caleb Todd (caleb.e.todd@gmail.com)",
  "url": "https://github.com/CalebTodd/aws-alb-content-pack",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "43cc7515-ccbd-4af4-89d0-6d5b2671dc5e",
      "data": {
        "name": "ELB_SSL_CIPHER",
        "pattern": "%{NOTSPACE}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "304fb0e7-13ca-4fce-9f45-5f669637d5d7",
      "data": {
        "name": "ELB_RECEIVED_BYTES",
        "pattern": "%{INT}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "0bcf4e4c-3129-4891-88c3-ad7dda804965",
      "data": {
        "name": "ELB_BACKEND_PROCESSING_TIME",
        "pattern": "%{NOTSPACE}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "d6ea5de6-099b-4783-822b-8c101d5e23c6",
      "data": {
        "name": "ELB_STATUS_CODE",
        "pattern": "%{INT}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "3ce6b6cb-d026-4e91-8ebf-7b7abcc6a2b9",
      "data": {
        "name": "ELB_NAME",
        "pattern": "%{NOTSPACE}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "5cbe4b1c-8e34-4338-b550-0e1f6e732ad7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "AWS Load Balancer Logs"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 12201
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": true
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "decompress_size_limit": {
            "@type": "integer",
            "@value": 8388608
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.gelf.tcp.GELFTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": [
          {
            "target_field": {
              "@type": "string",
              "@value": ""
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [],
            "configuration": {
              "grok_pattern": {
                "@type": "string",
                "@value": "%{ELB_TIMESTAMP} %{ELB_NAME} %{ELB_CLIENT_PORT} %{ELB_BACKEND_PORT} %{ELB_REQUEST_PROCESSING_TIME} %{ELB_BACKEND_PROCESSING_TIME} %{ELB_RESPONSE_PROCESSING_TIME} %{ELB_STATUS_CODE} %{ELB_BACKEND_STATUS_CODE} %{ELB_RECEIVED_BYTES} %{ELB_SENT_BYTES} %{ELB_REQUEST} %{ELB_USER_AGENT} %{ELB_SSL_CIPHER} %{ELB_SSL_PROTOCOL}"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "message"
            },
            "title": {
              "@type": "string",
              "@value": "AWS Load Balancer Logs"
            },
            "type": {
              "@type": "string",
              "@value": "GROK"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "5734a2b5-cf74-4562-a120-9a95ff3dceb4",
      "data": {
        "name": "ELB_RESPONSE_PROCESSING_TIME",
        "pattern": "%{NOTSPACE}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "65bcb165-e586-43e5-ba0a-45f16ac937dd",
      "data": {
        "name": "ELB_SENT_BYTES",
        "pattern": "%{INT}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "2794e3f0-4514-437c-99ef-6149904a9d93",
      "data": {
        "name": "ELB_REQUEST_PROCESSING_TIME",
        "pattern": "%{NOTSPACE}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "a091ccea-ec59-407f-bf1b-6a38e24806c9",
      "data": {
        "name": "ELB_BACKEND_STATUS_CODE",
        "pattern": "%{INT}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "9425e2ff-479d-4c61-95da-1ea00d5f3336",
      "data": {
        "name": "ELB_USER_AGENT",
        "pattern": "%{QUOTEDSTRING}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "69f09a17-1280-44ea-9b80-2fb0c317312a",
      "data": {
        "name": "ELB_TIMESTAMP",
        "pattern": "%{TIMESTAMP_ISO8601}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "40bb867b-9140-4075-a3b6-f9fd9873a3b3",
      "data": {
        "name": "ELB_REQUEST",
        "pattern": "%{QUOTEDSTRING}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "2f9189b3-e6e7-43ab-929d-30a9e8b5ef12",
      "data": {
        "name": "ELB_BACKEND_PORT",
        "pattern": "%{HOSTPORT}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "16f3c4ee-033e-4b27-8162-da2b57a9b0f0",
      "data": {
        "name": "ELB_SSL_PROTOCOL",
        "pattern": "%{NOTSPACE}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "043f5fd5-0271-4089-ab0f-f77ed6d046f6",
      "data": {
        "name": "ELB_CLIENT_PORT",
        "pattern": "%{HOSTPORT}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "d8236d4b-96c6-48c2-ada9-941737a93098",
      "data": {
        "name": "NOTSPACE",
        "pattern": "\\S+"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "5a6b6bd7-5d9f-4321-b166-ce06c5348bf0",
      "data": {
        "name": "INT",
        "pattern": "(?:[+-]?(?:[0-9]+))"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "4aa5200d-cf16-40b3-ab17-dfcadc42092f",
      "data": {
        "name": "QUOTEDSTRING",
        "pattern": "(?>(?<!\\\\)(?>\"(?>\\\\.|[^\\\\\"]+)+\"|\"\"|(?>'(?>\\\\.|[^\\\\']+)+')|''|(?>`(?>\\\\.|[^\\\\`]+)+`)|``))"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "b0571b6a-4d82-4e11-bd6e-c9d15842a080",
      "data": {
        "name": "TIMESTAMP_ISO8601",
        "pattern": "%{YEAR}-%{MONTHNUM}-%{MONTHDAY}[T ]%{HOUR}:?%{MINUTE}(?::?%{SECOND})?%{ISO8601_TIMEZONE}?"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "ff370816-74b1-401d-aa6d-768e8249e7bf",
      "data": {
        "name": "HOSTPORT",
        "pattern": "%{IPORHOST}:%{POSINT}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "f9876e2d-301f-43f5-a330-0f88e76cb772",
      "data": {
        "name": "YEAR",
        "pattern": "(?>\\d\\d){1,2}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "ea52ad94-8ad0-46ca-90bb-7c52af5011c4",
      "data": {
        "name": "MONTHNUM",
        "pattern": "(?:0?[1-9]|1[0-2])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "0db21863-83c0-48fd-91f1-9243555d3322",
      "data": {
        "name": "HOUR",
        "pattern": "(?:2[0123]|[01]?[0-9])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "be54db49-0172-4d0c-8593-fa11f162edc5",
      "data": {
        "name": "MINUTE",
        "pattern": "(?:[0-5][0-9])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "88ae2e85-3bc6-4470-b252-ee2f371ff6f0",
      "data": {
        "name": "SECOND",
        "pattern": "(?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?)"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "c52abd89-bc3d-40f6-80a2-38eb8a28a8bd",
      "data": {
        "name": "ISO8601_TIMEZONE",
        "pattern": "(?:Z|[+-]%{HOUR}(?::?%{MINUTE}))"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "fe3fec1a-6f29-4fde-94e6-a18f7567dd78",
      "data": {
        "name": "MONTHDAY",
        "pattern": "(?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "333f7d97-3944-4a2e-9f7a-e8b4b1664417",
      "data": {
        "name": "POSINT",
        "pattern": "\\b(?:[1-9][0-9]*)\\b"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "f50952e8-bf79-4d74-bbc0-d264e400001a",
      "data": {
        "name": "IPORHOST",
        "pattern": "(?:%{IP}|%{HOSTNAME})"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "1a954ed1-2493-4321-a485-b5f4667a12a9",
      "data": {
        "name": "HOSTNAME",
        "pattern": "\\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\\.?|\\b)"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "3d89de66-d627-4f18-9d15-0445c8a69e9d",
      "data": {
        "name": "IP",
        "pattern": "(?:%{IPV6}|%{IPV4})"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "ecb893a0-af4c-4a3c-a5d6-988727d78c06",
      "data": {
        "name": "IPV6",
        "pattern": "((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "a3b570e3-70a1-48a0-a06c-e1e523f6e9bc",
      "data": {
        "name": "IPV4",
        "pattern": "(?<![0-9])(?:(?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5]))(?![0-9])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.0.2+1686930"
        }
      ]
    }
  ]
}